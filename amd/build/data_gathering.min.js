define(["jquery"],function(a){var b=[],c=0,d={autosavetime:0,enablescreenshot:!1,showpredictionpoint:!1,showvideocanvas:!1};return{setParameters:function(a,b,c,e){d.autosavetime=a,d.enablescreenshot=b,d.showpredictionpoint=c,d.showvideocanvas=e},setLibraries:function(a,b){webgazer.setTracker(a),webgazer.setRegression(b)},init:function(e,f){var g=function(){c=a.now(),a(document).mousemove(function(d){if(void 0==webgazer||!webgazer.isReady()){var e=a.now()-c;e*=-1,b.push({x:d.pageX,y:d.pageY,time:e})}})},h=function(d){b.length>0&&(0==c&&webgazer.pause(),a.ajax({url:f,data:{sessionid:e,action:"savegazerdata",gazerdata:b},method:"POST"}).done(function(a){b=[],d()}).fail(function(){d()}))},i=function(){h(function(){0==c&&webgazer.resume()}),setTimeout(i,d.autosavetime)};a(window).blur(function(){h(function(){})}),a(window).unload(function(){h(function(){})}),a(window).focus(function(){0==c&&webgazer.resume()}),a(window).load(function(){g(),d.autosavetime>0&&i()})}}});